Урок 2 (со стрельбой и прочими безобразиями)

сначала сканируем пространство вокруг
поворачиваем радар сразу на 20 градусов, так как сектор сканирования 20 град (+\-10)

i=i+20        ;счетчик
if i>360      ; если больше 360 градусов
   i=0        ; обнуляем
endif
ScanRadar(i)   ;сканируем
(Для отладки вращения радара используйте клавишу М, будет видно последнее положение радара в вашем АИ)
Ищем врагов используя переменную enemy

if enemy<>0     ; Если радар нашел врага (проверяем значения встроенных переменных)                          
  if target%=0  ; Если наша переменная цели равна 0
   target%=enemy   ; Заносим врага в переменную цель
  endif
endif

Наводим орудие

if target<>0                         ; если цель есть
  dist_t=EntityDistance(corpus%,target) ; определяем дистанцию
  ppr=dist_t#/800                       ; определяем поправку на дальность
   turnturret=deltayaw(turret,target)   ; поворачиваем орудие на цель
   if abs(turnturret)<10                ; если уже повернулось в сторону цели
     turngun=deltapitch(gun,target)-ppr ; поднимаем\опускаем ствол с учетом поправки
     if abs(turngun)<2                  ; если ствол наведен
       fire1=1                          ; огонь !
     endif
   endif

   if rockets>0                          ; если есть ракеты
     if dist_t>500                       ; если дистанция больше 50 метров
      TurnCorpus=deltayaw(corpus%,target);поворачиваем бота на цель
     endif
   endif

   if dist_t<600                         ;если дистанция меньше 60 м
     fire2=1                             ; пускаем ракету
   endif
endif

Копируем код из первого урока, вставляем после кода второго урока.
Запускаем. Все работает. 
Но вот кончились ракеты и снаряды, и бой прекратился. 
В следующем уроке ищем бонусы.
